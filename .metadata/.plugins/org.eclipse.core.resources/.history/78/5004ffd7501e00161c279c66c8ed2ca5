<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Insert title here</title>
<script type="text/javascript">
<!-- Original Ajax -->
var httpRequest;

function getXMLHttpReqeust(){
   if(window.ActiveXObject){ //IE라면 (인터넷 익스플로우)
       try{
         return new ActiveXObject("Msxml2.XMLHTTP");
      }catch(e1){
         try{
            return new ActiveXObject("Microsoft.XMLHTTP");
         }catch(e2){
            return null;
         }
      }
   }else if(window.XMLHttpRequest){// 크롬, 사파리, 등등
      return new XMLHttpRequest();
   }else{
      return null;
   }
}
 function timestart(){
    httpRequest = getXMLHttpReqeust();
    httpRequest.onreadystatechange = timeget;
		<!-- readtState가 바뀔때마다 처리하는 함수 : callback함수 -->
			<!-- 0(객페만 생성, Unitialized), 1(open메서드에서 호출), ..., ?? -->
		<!-- callback함수로 timeget이라는 함수를 쓰겠다. -->
	httpRequest.open("GET","/ajaxtest/time.jsp",true);
		<!-- 서버하고 연결을 해라, "연결방식","요청주소(controller)", 비동기화(true)/동기화(flase) -->
		<!-- Get방식으로 "서버의요청주소"와 비동기방식으로 연결해라-->
	httpRequest.send(null);
		<!-- 요청해라. 인자가 없을땐 null -->
 }
 
 function timeget(){

	 var vt = document.getElementById("currenttime");
	if(httpRequest.readyState == 4) {
		<!-- 4 : 응답받았을때, 시간 뿌릴 것-->
		if(httpRequest.status == 200) {
			<!-- 정상적인 응답일  때만 뿌림 -->
			var ctime = httpRequest.responseText;
			vt.innerHTML = ctime;
			window.setTimeout("timestart();", 1000);
		} else {
			alert("문제발생 : " + httpRequest.status);
		}
		
	} else { <!-- 응답 기다릴 때-->
		vt.innerHTML = "<img src='/ajaxtest/img/loading.gif' width='80'>";
	}
 }
</script>

</head>
<body>
	<font color="gray" size="50">현재 시간 :</font>
	<div id="currenttime" width="100">
	</div>
	<input type="button" value="시간" onclick="javascript:timestart();">
</body>
</html>